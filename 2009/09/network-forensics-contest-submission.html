<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Network Forensics Contest submission - Grey Panther's Place</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="https://www.grey-panther.net/favicon.ico" rel="icon">
    <!--[if IE]><link rel="shortcut icon" href="https://www.grey-panther.net/favicon.ico"><![endif]-->

<link rel="canonical" href="https://www.grey-panther.net/2009/09/network-forensics-contest-submission.html">

        <meta name="author" content="Attila-Mihaly Balazs" />
        <meta name="keywords" content="challenge,networking,solution" />
        <meta name="description" content="Some time ago I mentioned the Network Forensics Puzzle. The contest is now over and since I didn’t win, I’ll publish my submission below – it was after all correct, but not quite what the judges were looking for (congratulation to the winner). After validating that the MD5 sum ..." />

        <meta property="og:site_name" content="Grey Panther's Place" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Network Forensics Contest submission"/>
        <meta property="og:url" content="https://www.grey-panther.net/2009/09/network-forensics-contest-submission.html"/>
        <meta property="og:description" content="Some time ago I mentioned the Network Forensics Puzzle. The contest is now over and since I didn’t win, I’ll publish my submission below – it was after all correct, but not quite what the judges were looking for (congratulation to the winner). After validating that the MD5 sum ..."/>
        <meta property="article:published_time" content="2009-09-29" />
            <meta property="article:section" content="archived" />
            <meta property="article:tag" content="challenge" />
            <meta property="article:tag" content="networking" />
            <meta property="article:tag" content="solution" />
            <meta property="article:author" content="Attila-Mihaly Balazs" />

    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@cdman83">
        <meta name="twitter:creator" content="@cdman83">
    <meta name="twitter:domain" content="https://www.grey-panther.net">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.grey-panther.net/theme/css/bootstrap.superhero.min.css" type="text/css"/>
    <link href="https://www.grey-panther.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.grey-panther.net/theme/css/pygments/solarizeddark.css" rel="stylesheet">
        <link href="https://www.grey-panther.net/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.grey-panther.net/theme/css/style.css" type="text/css"/>

        <link href="https://www.grey-panther.net/feeds/posts/default" type="application/atom+xml" rel="alternate"
              title="Grey Panther's Place ATOM Feed"/>

        <link href="https://www.grey-panther.net/feeds/rss" type="application/rss+xml" rel="alternate"
              title="Grey Panther's Place RSS Feed"/>



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://www.grey-panther.net/" class="navbar-brand">
Grey Panther's Place            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/">About</a></li>
                    <li><a href="/category/blog.html">Blog</a></li>
                    <li><a href="/pages/projects.html">Projects</a></li>
                    <li><a href="/pages/sitemap.html">More</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://www.grey-panther.net/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://www.grey-panther.net/2009/09/network-forensics-contest-submission.html"
                       rel="bookmark"
                       title="Permalink to Network Forensics Contest submission">
                        Network Forensics Contest&nbsp;submission
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2009-09-29T13:26:00+03:00"> Ma 29 septembrie 2009</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://www.grey-panther.net/tag/challenge.html">challenge</a>
        /
	<a href="https://www.grey-panther.net/tag/networking.html">networking</a>
        /
	<a href="https://www.grey-panther.net/tag/solution.html">solution</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Some time ago <a href="http://hype-free.blogspot.com/2009/08/couple-of-challenges.html">I mentioned the Network Forensics
Puzzle</a>.
The contest is now over and since I didn’t win, I’ll publish my
submission below – it was after all correct, but not quite what the
judges were looking for (congratulation <a href="http://forensicscontest.com/">to the
winner</a>).</p>
<p>After validating that the <span class="caps">MD5</span> sum for the downloaded file matches the
one specified on the website, I first opened it up in NetworkMiner
(<a href="http://networkminer.sourceforge.net/">http://networkminer.sourceforge.net/</a>). I find the overview it gives
much easier to understand than the statistics provided by Wireshark.
Using it I identified the data stream between Ann&#8217;s computer and the
unidentified&nbsp;laptop.</p>
<p>1. What is the name of Ann’s <span class="caps">IM</span> buddy?<br />
Sec558user1 - this is tricky because the <span class="caps">IM</span> (which seems to be <span class="caps">AOL</span> - but
many other <span class="caps">IM</span>&#8217;s behave in a similar fashion) routes chat traffic trough
central servers (64.12.24.50 in this case - which belongs to <span class="caps">AOL</span>, making
it even more probable that <span class="caps">AIM</span> was used) to make <span class="caps">NAT</span> traversal a
non-issue, while file transfers are done trough direct connection to
conserve&nbsp;bandwidth.</p>
<p>2. What was the first comment in the captured <span class="caps">IM</span> conversation?<br />
Here&#8217;s the secret recipe&#8230; I just downloaded it from the file server.
Just copy to a thumb drive and you&#8217;re good to go >:-)<br />
(actually, > is escaped as <span class="caps">HTML</span> - ie >)</p>
<p>3. What is the name of the file Ann transferred?<br />&nbsp;recipe.docx</p>
<p>4. What is the magic number of the file you want to extract (first four
bytes)?<br />
50 4B 03 04 - Which corresponds to <span class="caps">PK</span>&#8230;, signaling that we are
potentially dealing with a <span class="caps">ZIP</span> archive here. This is further reinforced
by the filename (.docx, which is the new &#8220;open&#8221; document format from
Microsoft - basically, it consists out of a zipped <span class="caps">XML</span> - similarly to
the OpenOffice.org&nbsp;format)</p>
<p>5. What was the MD5sum of the file?<br />&nbsp;8350582774e1d4dbe1d61d64c89e0ea1</p>
<p>This is again tricky, because <span class="caps">ZIP</span> (like many other formats) admit
arbitrary data after the logical end of the file. So, using a hex
editor, we first carve the the part starting at <span class="caps">PK</span> in the
192.168.1.158 -> 192.168.1.159 (be careful not to include the traffic
in the reverse direction). Then we need to convince ourselves that the
end of the file has been correctly identified at the byte level. To do
this we could study the <span class="caps">ZIP</span> specification
(<a href="http://www.pkware.com/index.php?option=com_content&amp;task=view&amp;id=64&amp;Itemid=107">http://www.pkware.com/index.php?option=com_content&task;=view&id;=64&Itemid;=107</a>)
or use a more empirical level: using a hex editor (HxD for example -
<a href="http://mh-nexus.de/en/hxd/">http://mh-nexus.de/en/hxd/</a>) eliminate the last byte of the file and
&#8220;test&#8221; the integrity of the file (using the Test option from 7-zip for
example - <a href="http://www.7-zip.org/">http://www.7-zip.org/</a> - but one could use almost any
de-archiving program, since almost all of them offer a &#8220;Test&#8221; option).
The test will fail. Now add back the last byte (which is 0x00) and
perform the test again. It will succeeded. This means with a big
probability that we correctly identified the actual (logical) end of the&nbsp;file.</p>
<p>6. What is the secret recipe?<br />
The most recent version of OpenOffice.org (3.1.x) can open the docx
format, so the following can be retrieved on any platform, regardless of
whether <span class="caps">MS</span> Office 2007 is installed (an alternative solution would be to
use the free <span class="caps">MS</span> Word 2007 viewer or the import filters available for
older versions of <span class="caps">MS</span>&nbsp;Office).</p>
<p>The contents (sans the formatting):<br />
Recipe for Disaster:<br />
1 serving<br />
Ingredients:<br />
4 cups sugar<br />
2 cups water<br />
In a medium saucepan, bring the water to a boil. Add sugar. Stir gently
over low heat until sugar is fully dissolved. Remove  the  saucepan from
heat.  Allow to cool completely. Pour into gas tank. Repeat as&nbsp;necessary.</p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="https://www.grey-panther.net/2009/09/ethical-hacker-challenge-prison-break.html">Ethical Hacker challenge “Prison Break”&nbsp;solution</a></li>
        <li><a href="https://www.grey-panther.net/2009/08/t2-challenge.html">T2&#8216;09&nbsp;Challenge</a></li>
        <li><a href="https://www.grey-panther.net/2011/01/remote-debugging-with-java.html">Remote debugging with&nbsp;Java</a></li>
        <li><a href="https://www.grey-panther.net/2011/02/why-you-should-use-0000-in-your-hosts.html">Why you should use 0.0.0.0 in your hosts file -&nbsp;redux</a></li>
        <li><a href="https://www.grey-panther.net/2010/01/announcing-couple-of-contests.html">Announcing a couple of&nbsp;contests</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="60%" class="img" src="/images/profile.png"/>
        </p>
    <p>
        <strong>About Grey Panther</strong><br/>
        <a href="/">father, husband, software craftsman</a>
    </p>
</div>
<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://ro.linkedin.com/in/gpanther"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
                <li class="list-group-item"><a href="http://stackoverflow.com/users/1265/grey-panther"><i class="fa fa-stack-overflow fa-lg"></i> stackoverflow</a></li>
                <li class="list-group-item"><a href="https://github.com/gpanther/"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>





    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Grey Panther
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://www.grey-panther.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.grey-panther.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.grey-panther.net/theme/js/respond.min.js"></script>


</body>
</html>