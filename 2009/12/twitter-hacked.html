<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Twitter hacked - Grey Panther's Place</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="https://www.grey-panther.net/favicon.ico" rel="icon">
    <!--[if IE]><link rel="shortcut icon" href="https://www.grey-panther.net/favicon.ico"><![endif]-->

<link rel="canonical" href="https://www.grey-panther.net/2009/12/twitter-hacked.html">

        <meta name="author" content="Attila-Mihaly Balazs" />
        <meta name="keywords" content="security,hack,deface,twitter,web" />
        <meta name="description" content="slashdot_url=&#34;http://hype-free.blogspot.com/2009/12/twitter-hacked.html&#34;; ![DiggThis](http://digg.com/img/diggThis.png) It had to happen, didn’t it? I’ve fired up Pidgin with the microblog-purple plugin, only to get an “invalid certificate” error for twitter. I’ve quickly became nervous, since a quick digging ..." />

        <meta property="og:site_name" content="Grey Panther's Place" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Twitter hacked"/>
        <meta property="og:url" content="https://www.grey-panther.net/2009/12/twitter-hacked.html"/>
        <meta property="og:description" content="slashdot_url=&#34;http://hype-free.blogspot.com/2009/12/twitter-hacked.html&#34;; ![DiggThis](http://digg.com/img/diggThis.png) It had to happen, didn’t it? I’ve fired up Pidgin with the microblog-purple plugin, only to get an “invalid certificate” error for twitter. I’ve quickly became nervous, since a quick digging ..."/>
        <meta property="article:published_time" content="2009-12-18" />
            <meta property="article:section" content="archived" />
            <meta property="article:tag" content="security" />
            <meta property="article:tag" content="hack" />
            <meta property="article:tag" content="deface" />
            <meta property="article:tag" content="twitter" />
            <meta property="article:tag" content="web" />
            <meta property="article:author" content="Attila-Mihaly Balazs" />

    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@cdman83">
        <meta name="twitter:creator" content="@cdman83">
    <meta name="twitter:domain" content="https://www.grey-panther.net">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.grey-panther.net/theme/css/bootstrap.superhero.min.css" type="text/css"/>
    <link href="https://www.grey-panther.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.grey-panther.net/theme/css/pygments/solarizeddark.css" rel="stylesheet">
        <link href="https://www.grey-panther.net/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.grey-panther.net/theme/css/style.css" type="text/css"/>

        <link href="https://www.grey-panther.net/feeds/posts/default" type="application/atom+xml" rel="alternate"
              title="Grey Panther's Place ATOM Feed"/>

        <link href="https://www.grey-panther.net/feeds/rss" type="application/rss+xml" rel="alternate"
              title="Grey Panther's Place RSS Feed"/>



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://www.grey-panther.net/" class="navbar-brand">
Grey Panther's Place            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/">About</a></li>
                    <li><a href="/category/blog.html">Blog</a></li>
                    <li><a href="/pages/projects.html">Projects</a></li>
                    <li><a href="/pages/site-map.html">More</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://www.grey-panther.net/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://www.grey-panther.net/2009/12/twitter-hacked.html"
                       rel="bookmark"
                       title="Permalink to Twitter hacked">
                        Twitter&nbsp;hacked
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2009-12-18T13:16:00+02:00"> Vi 18 decembrie 2009</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://www.grey-panther.net/tag/security.html">security</a>
        /
	<a href="https://www.grey-panther.net/tag/hack.html">hack</a>
        /
	<a href="https://www.grey-panther.net/tag/deface.html">deface</a>
        /
	<a href="https://www.grey-panther.net/tag/twitter.html">twitter</a>
        /
	<a href="https://www.grey-panther.net/tag/web.html">web</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <div style="float: right;">

<script type="text/javascript"><br />
    slashdot_url="http://hype-free.blogspot.com/2009/12/twitter-hacked.html";<br />
</script>
<script src="http://slashdot.org/slashdot-it.js" type="text/javascript"></script>

</div>

<div style="float: right; clear: right; margin-top: 1em;">

<a class="DiggThisButton">
![DiggThis](http://digg.com/img/diggThis.png)</a>
<script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>

</div>

<p>It had to happen, didn’t it? I’ve fired up
<a href="http://www.pidgin.im/">Pidgin</a> with the
<a href="http://code.google.com/p/microblog-purple/">microblog-purple</a> plugin,
only to get an “invalid certificate” error for twitter. I’ve quickly
became nervous, since a quick digging indicated that I was getting the
wrong <span class="caps">IP</span> address for the domain&nbsp;twitter.com.</p>
<p>My first thought was: “I’ve been compromised”. After quickly verifying
my hosts file and my <span class="caps">DNS</span> entry, all seemed fine on the surface. My
second thought was: “my <span class="caps">DNS</span> server was compromised”, so I’ve done the
same lookup using OpenDNS and the new Google <span class="caps">DNS</span>, both coming up with
different (but wrong) answers. Finally I’ve checked out a couple of
other <span class="caps">HTTPS</span> sites and they seemed fine. So I took a deep breath and
(putting my faith in <a href="http://noscript.net/">NoScript</a> and
<a href="http://www.requestpolicy.com/">RequestPolicy</a>) visited twitter.com to
find the following&nbsp;page:</p>
<p><img alt="twitter_hack" src="http://lh4.ggpht.com/_hrvCBhtWhJ4/SyssNIUA3aI/AAAAAAAACEE/XW1kUzm_yg4/twitter_hack%5B6%5D.png?imgmax=800" title="twitter_hack" /></p>
<p>Quick&nbsp;analysis:</p>
<ul>
<li>This seems to be a “good old”&nbsp;defacement</li>
<li>A very likely scenario is that they somehow compromised the <span class="caps">DNS</span>
    registrar account (phising, dumb password reset, etc) and changed it
    to point to an other <span class="caps">IP</span>.</li>
<li>Currently I’m seeing a couple of different IPs out there for the
    twitter.com domain:<ul>
<li>My <span class="caps">DNS</span> server (and OpenDNS) returns
    <a href="http://domaintools.com/66.147.242.88">66.147.242.88</a></li>
<li>Google <span class="caps">DNS</span> returns
    <a href="http://whois.domaintools.com/74.217.128.160">74.217.128.160</a></li>
</ul>
</li>
<li>
<p>The correct address seems to be
    <a href="http://whois.domaintools.com/twitter.com">168.143.171.84</a>, so if
    you put the following line in your host file, thing should start
    working again (you might need to do an <code>ipconfig /flushdns</code> if
    you&#8217;re on&nbsp;Windows):</p>
<div class="highlight"><pre><span></span>168.143.171.84 twitter.com
</pre></div>


</li>
<li>
<p>The above is a hackish solution, and I would recommend using it only
    in life-and-death situations :-p. It is the best to let Twitter
    handle the incident and make sure that everything is cleaned&nbsp;up.</p>
</li>
<li>It is unclear when exactly the defacement happened, but it must have
    been in the last 10 hours or so. It might have been specifically
    targeted so that it is late in the day in the <span class="caps">USA</span> so that the
    reaction is&nbsp;delayed.</li>
<li>
<p>~~According to <a href="http://translate.google.com/#">Google Translate</a>
    (<a href="http://babelfish.yahoo.com/">Babelfish</a> doesn’t know Arabic
    unfortunately) the text below the picture&nbsp;says:~~</p>
<p>Ok, so I&#8217;m a big ignorant idiot. The official language of Iran is
<a href="http://en.wikipedia.org/wiki/Persian_language">Persian</a> (also known
as Farsi or Parsi), not Arabic. Thank you to Anonymous for pointing
it out. According to <a href="http://www.mirror.co.uk/news/top-stories/2009/12/18/twitter-hacked-by-iranian-protesters-115875-21907173/">this
article</a>
the text in the picture&nbsp;says:</p>
<blockquote>
<p>This site has been hacked by the Iranian Cyber Army (on the&nbsp;flag)</p>
</blockquote>
<p>and</p>
<blockquote>
<p>The <span class="caps">USA</span> thinks they control and manage internet access, but they
don&#8217;t. We control and manage the internet with our power, so do
not try to incite the Iranian people (under the&nbsp;picture)</p>
</blockquote>
<p>Some people also seem to have screenshots with English texts on&nbsp;them.</p>
</li>
<li>
<p>The rogue server doesn’t seem to respond to any Twitter <span class="caps">API</span>
    requests, so it doesn’t seem to be that they were going after
    usernames and passwords (which they very well might have done,
    considering the number of users who click trough <span class="caps">SSL</span> certificate
    warnings), but just to be on the safe side, <em>change your password</em>
    and <em>don’t use the same password on all the sites</em>!</p>
</li>
</ul>
<p><em>Update</em>: As of now all seems to be back to normal and all the <span class="caps">DNS</span>
servers return the correct <span class="caps">IP</span> address. I’m waiting for an explanation in
Twitter (mostly because I’m interested in how it happened&nbsp;:-)).</p>
<p><em>Update</em>: <a href="http://blog.twitter.com/2009/12/dns-disruption.html">Twitter acknowledges the
hack</a> on their blog
and say that they will provide more information as it becomes available
(however they erroneously affirm that the <span class="caps">API</span> were working correctly –
they weren’t, since they used the same <span class="caps">DNS</span> record to contact Twitter –
in fact this is how I’ve became aware of the&nbsp;hack).</p>
<p>Bonus: what sources can you use to investigate such&nbsp;incidents?</p>
<ul>
<li>First of all, be suspicious of <span class="caps">SSL</span> certificate errors! I know that
    they (sadly) are quite common these days, but be&nbsp;vigilant!</li>
<li>Check that the problem is not at your end. Check that you have the
    correct <span class="caps">DNS</span> server (there are a couple of malware families out there
    which set a custom <span class="caps">DNS</span> server for the machine to control the users
    browsing destinations). Check that the given hostname is not present
    in your hosts file (again, there are a couple of malware families
    using this method to misdirect&nbsp;users)</li>
<li>Check what the <span class="caps">IP</span> address should be, by using
    <a href="http://whois.domaintools.com/twitter.com">domaintools</a> for example
    (and looking at the server stats&nbsp;page)</li>
<li>
<p>Try looking up the <span class="caps">DNS</span> name using several <span class="caps">DNS</span> servers (this might
    not work if your network filters <span class="caps">DNS</span>&nbsp;queries):</p>
<div class="highlight"><pre><span></span># nslookup
&gt; set type=ANY
&gt; twitter.com
...
&gt; server 8.8.8.8
&gt; twitter.com
...
&gt; server 208.67.222.222
&gt; twitter.com
...
</pre></div>


</li>
<li>
<p>An other option is to use the <a href="http://vurl.mysteryfcm.co.uk/?url=1160923">vURL
    service</a> to fetch the
    suspicious webpage from different location and compare the results
    with what you are&nbsp;seeing.</p>
</li>
</ul>
<p>Using these methods you can quickly ascertain with pretty good accuracy
where the fault lies and take appropriate action. Have a safe holiday&nbsp;everybody!</p>
<p><em>Update</em>:</p>
<ul>
<li>Read about the subject on <a href="http://countermeasures.trendmicro.eu/twitter-not-hacked-by-iranian-cyber-army/">the TrendMicro Countermeasures
    Blog</a>.</li>
<li>Some more links to information and the source of the defaced webpage
    at <a href="http://news.ycombinator.com/item?id=1002640">Hacker News</a>.</li>
<li><span class="caps">SANS</span> <a href="https://isc.sans.org/diary.html?storyid=7774">posted about in
    issue</a> in the&nbsp;diary.</li>
<li>I&#8217;ve update the translations, thanks to&nbsp;Anonymous</li>
<li>Twitter <a href="http://blog.twitter.com/2009/12/update-on-last-nights-dns-disruption.html">posted an
    update</a>
    about the issue. It doesn&#8217;t many more details, it does however give
    a timeframe for the problem: between 21:46 and 23:00 <span class="caps">PST</span> . There are
    some rumors out there that somehow (phising?) the correct password
    to the <span class="caps">DNS</span> management interface was obtained and it was used to
    modify the records. Twitter still has the original blogpost up
    saying that <span class="caps">API</span>&#8217;s were not affected, but <em>this is not true</em>! If
    you&#8217;ve used a third party Twitter client and you&#8217;ve clicked trough
    the certificate warning (or maybe it doesn&#8217;t use <span class="caps">TLS</span> at all), your
    password might have been compromised. Currently there is no evidence
    that the rogue server was logging passwords, but until the time some
    forensics is done on it, there is no sure way to tell if this was
    the case (since it is trivial to configure a webserver such that it
    responds with a 404 error, while still logging the details of the&nbsp;request).</li>
<li>Arbor Networks <a href="http://asert.arbornetworks.com/2009/12/your-dns-is-an-asset-twitter-dns-woes/">posted a related
    article</a>.</li>
<li>Sucuri has also <a href="http://blog.sucuri.net/2009/12/twitter-defacement.html">posted about the
    issue</a>. They
    have a nice little network monitoring / alerting system. You can
    also use them as <a href="http://sucuri.net/index.php?page=scan&amp;scan=www.twitter.com">a third-party information
    source</a>.</li>
<li><span class="caps">ISS</span> X-Force (part of <span class="caps">IBM</span>) has also <a href="http://blogs.iss.net/archive/dnsresolution.html">a nice writeup about the
    incident</a>.</li>
<li>Brian Krebs has <a href="http://voices.washingtonpost.com/securityfix/2009/12/twittercom_hijacked_by_iranian.html?wprss=securityfix">an informative
    writeup</a>
    on the SecurityFix blog about the issue which quotes Dyn&#8217;s (the host
    for the Twitter <span class="caps">DNS</span>) <span class="caps">CTO</span> as saying: &#8220;Someone logged in who purported
    to be a legitimate user of their [<span class="caps">DNS</span>] platform account and started
    making changes&#8221;, further strengthening the probability that a
    Twitter employee&#8217;s email account was broken into via some&nbsp;mechanism.</li>
<li>There is also a lot of confusion out there, as it always is the case
    with (security) news. I&#8217;ve heard someone saying that &#8220;why did the
    <span class="caps">DNS</span> host allow the redirection of Twitter to a host in Iran?&#8221; - just
    to clarify: even though the hack was claimed by the &#8220;Iranian Cyber
    Army&#8221; (which might not mean anything! it could be your nerdy
    neighbor), the server it was redirected to was in the <span class="caps">US</span>.</li>
</ul>
<p><img alt="3036343674_54b4674f93_b" src="http://lh6.ggpht.com/_hrvCBhtWhJ4/SytP_Yh5udI/AAAAAAAACEM/HwP5a7SjhWw/3036343674_54b4674f93_b%5B7%5D.jpg?imgmax=800" title="3036343674_54b4674f93_b" /></p>
<p>Picture taken from <a href="http://www.flickr.com/photos/25636851@N03/">pugetsoundphotowalks&#8217;
photostream</a> with&nbsp;permission.</p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="https://www.grey-panther.net/2010/01/forensic-analysis-of-jpeg-images.html">Forensic analysis of <span class="caps">JPEG</span>&nbsp;images</a></li>
        <li><a href="https://www.grey-panther.net/2009/09/back-with-vengeance.html">Back with a&nbsp;vengeance</a></li>
        <li><a href="https://www.grey-panther.net/2010/05/on-hopelessness-of-pulling-content-from.html">On the hopelessness of pulling content from the&nbsp;interwebs</a></li>
        <li><a href="https://www.grey-panther.net/2009/12/congratulation-to-av-comparatives.html">Congratulation to <span class="caps">AV</span>-Comparatives!</a></li>
        <li><a href="https://www.grey-panther.net/2010/03/spammy-mike.html">Spammy&nbsp;Mike</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="60%" class="img" src="/images/profile.png"/>
        </p>
    <p>
        <strong>About Grey Panther</strong><br/>
        <a href="/">father, husband, software craftsman</a>
    </p>
</div>
<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://ro.linkedin.com/in/gpanther"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
                <li class="list-group-item"><a href="http://stackoverflow.com/users/1265/grey-panther"><i class="fa fa-stack-overflow fa-lg"></i> stackoverflow</a></li>
                <li class="list-group-item"><a href="https://github.com/gpanther/"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>





    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Grey Panther
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://www.grey-panther.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.grey-panther.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.grey-panther.net/theme/js/respond.min.js"></script>


</body>
</html>